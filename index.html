<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Chronicle Chains</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Arial, sans-serif; background-color: #1e1e1e; background-image: url("https://i.pinimg.com/originals/6d/7c/65/6d7c65bbef77082a19ff4a2a2327d50d.jpg"); background-size: cover; background-position: center; }

.container { max-width: 460px; margin: 0 auto; padding: 16px; position: relative; }

h1 { text-align: center; color: #fff; margin: 20px 0; }

.search { width: 100%; padding: 12px; border-radius: 12px; border: none; margin-bottom: 20px; font-size: 16px; }

.products { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 14px; justify-items: center; }

.product {
  background: rgba(0,0,0,0.6);
  border-radius: 14px;
  padding: 8px;
  text-align: center;
  width: 160px;
  aspect-ratio: 1 / 1;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition: transform 0.2s, box-shadow 0.2s;
  cursor: pointer;
}
.product:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.5); }

.product img { width: 100%; height: 60%; object-fit: cover; border-radius: 10px; }

.product h3 { color: #fff; font-size: 14px; margin-top: 6px; }
.product p { color: #ccc; font-size: 13px; }

.add-btn, .remove-btn {
  margin-top: 6px; padding: 8px; border-radius: 10px; border: none; background: #333; color: white; font-size: 14px; cursor: pointer;
}

.tg-btn { background-color: #333 !important; color: white !important; }

.cart-bottom { position: fixed; bottom: 0; left: 0; width: 100%; max-width: 460px; background: rgba(50,50,50,0.95); display: flex; justify-content: center; padding: 12px; z-index: 5; }

.cart-button { width: 90%; padding: 14px; font-size: 18px; border-radius: 12px; border: none; background: #333; color: white; cursor: pointer; }

.modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center; }
.modal-content { background: #1e1e1e; padding: 16px; border-radius: 12px; max-width: 360px; width: 90%; text-align: center; position: relative; }
.modal-content img { width: 100%; max-height: 300px; object-fit: contain; border-radius: 10px; }
.modal-close { position: absolute; top: 8px; right: 12px; color: white; font-size: 24px; cursor: pointer; }

</style>
</head>
<body>

<div class="container">
  <h1>Chronicle Chains</h1>
  <input type="text" class="search" placeholder="Поиск..." oninput="filterProducts(this.value)">
  <div class="products" id="products"></div>
</div>

<div class="cart-bottom">
  <button class="cart-button" id="cartBtn">Корзина</button>
</div>

<!-- Модальное окно товара -->
<div class="modal" id="modal">
  <div class="modal-content">
    <span class="modal-close" id="modalClose">&times;</span>
    <img id="modalImage" src="">
    <h3 id="modalTitle"></h3>
    <p id="modalPrice"></p>
    <button class="add-btn" id="modalAdd">В корзину</button>
  </div>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let cart = [];
let currentModalProduct = null;

const products = [
  { id: 1, name: "Колье Pierced Chain", price: 2500, image: "https://i.pinimg.com/736x/37/0b/db/370bdb870346b42b1000610195261f62.jpg" },
  { id: 2, name: "Колье Starry Sky", price: 4500, image: "https://i.pinimg.com/736x/55/bf/ec/55bfecc3c2ceebf20752ff2802ff4e19.jpg" },
  { id: 3, name: "Колье Gothic Thorns", price: 3600, image: "https://i.pinimg.com/736x/c2/0d/26/c20d26fb9839c64d328f8989450f547b.jpg" },
  { id: 4, name: "Браслет Hearts", price: 4000, image: "https://i.pinimg.com/736x/d4/c5/4c/d4c54cd9c489d1e73d9e306545929b70.jpg" },
  { id: 5, name: "Обвес Lighter", price: 3600, image: "https://i.pinimg.com/736x/e8/cb/c2/e8cbc2287025b23930c20e030755a0b5.jpg" },
  { id: 6, name: "Обвес Star", price: 2000, image: "https://i.pinimg.com/736x/16/36/75/163675cf410dfc51ef97238bbbab1056.jpg" },
  { id: 7, name: "Серьги Moonlight", price: 2000, image: "https://i.pinimg.com/736x/93/e4/e5/93e4e5ee7594f6ef436f8b994ef04016.jpg" },
  { id: 8, name: "Кулон с цепочкой Moonlight", price: 2000, image: "https://i.pinimg.com/736x/5a/6d/1b/5a6d1beecdc7b79798705e4da0ef3a5c.jpg" },
];

const containerEl = document.getElementById("products");
const modal = document.getElementById("modal");
const modalImage = document.getElementById("modalImage");
const modalTitle = document.getElementById("modalTitle");
const modalPrice = document.getElementById("modalPrice");
const modalClose = document.getElementById("modalClose");
const modalAdd = document.getElementById("modalAdd");
const cartBtn = document.getElementById("cartBtn");

// Рендер каталога
function renderProducts(list = products){
  containerEl.innerHTML = "";
  list.forEach(p=>{
    const card = document.createElement("div");
    card.className="product";
    const img = new Image();
    img.src=p.image; img.alt=p.name; img.onerror=()=>img.src="https://via.placeholder.com/300";
    card.innerHTML=`<h3>${p.name}</h3><p>${p.price} ₽</p><button class="add-btn">В корзину</button>`;
    card.prepend(img);

    // открыть модальное окно
    card.onclick=()=>openModal(p);
    card.querySelector(".add-btn").onclick=(e)=>{ e.stopPropagation(); addToCart(p); }

    containerEl.appendChild(card);
  });
}

// Фильтр
function filterProducts(value){
  value=value.toLowerCase();
  renderProducts(products.filter(p=>p.name.toLowerCase().includes(value)));
}

// Модальное окно
function openModal(p){
  currentModalProduct=p;
  modalImage.src=p.image;
  modalTitle.textContent=p.name;
  modalPrice.textContent=`${p.price} ₽`;
  modal.style.display="flex";
}
modalClose.onclick=()=>modal.style.display="none";
window.onclick=(e)=>{if(e.target===modal) modal.style.display="none";}
modalAdd.onclick=()=>{if(currentModalProduct) addToCart(currentModalProduct);}

// Корзина
function addToCart(product){
  cart.push(product);
  alert(`${product.name} добавлен в корзину`);
}
cartBtn.onclick=()=>{ renderCart(); }

function renderCart(){
  containerEl.innerHTML="";
  document.body.style.backgroundColor="#000";
  if(cart.length===0){
    containerEl.innerHTML=`<p style="color:white; text-align:center; margin-top:20px;">Корзина пуста</p>`;
  }else{
    cart.forEach((p,i)=>{
      const card=document.createElement("div");
      card.className="product";
      const img=new Image();
      img.src=p.image; img.alt=p.name; img.onerror=()=>img.src="https://via.placeholder.com/300";
      card.innerHTML=`<h3>${p.name}</h3><p>${p.price} ₽</p><button class="remove-btn">Удалить</button>`;
      card.prepend(img);
      card.querySelector(".remove-btn").onclick=()=>{ cart.splice(i,1); renderCart(); }
      containerEl.appendChild(card);
    });
    const total=cart.reduce((sum,item)=>sum+item.price,0);
    const divTotal=document.createElement("div");
    divTotal.className="cart-total";
    divTotal.textContent=`Итого: ${total} ₽`;
    containerEl.appendChild(divTotal);
  }
}

renderProducts();
</script>

</body>
</html>
