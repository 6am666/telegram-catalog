<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Shop</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!-- DaData -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/suggestions-jquery@21.12.0/dist/css/suggestions.min.css">
<script src="https://cdn.jsdelivr.net/npm/suggestions-jquery@21.12.0/dist/js/jquery.suggestions.min.js"></script>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#111;
  color:#fff;
}
button{
  padding:10px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
input,select{
  width:100%;
  padding:10px;
  margin:8px 0;
  border-radius:6px;
  border:1px solid #444;
  background:#222;
  color:#fff;
}
.product{
  padding:15px;
  border-bottom:1px solid #333;
}
.cart-btn{
  position:fixed;
  bottom:20px;
  right:20px;
  background:#6c4cff;
  color:#fff;
}
#orderModal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  justify-content:center;
  align-items:center;
}
.modal{
  background:#1c1c1c;
  padding:20px;
  border-radius:10px;
  width:90%;
  max-width:400px;
}
.suggestions-suggestions{
  background:#fff !important;
  color:#000 !important;
  z-index:999999 !important;
}
.suggestions-item{
  color:#000 !important;
}
</style>
</head>

<body>

<h2 style="padding:15px">–ö–∞—Ç–∞–ª–æ–≥</h2>

<div id="products"></div>

<button class="cart-btn" id="openOrder">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>

<div id="orderModal">
  <div class="modal">
    <h3>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h3>
    <form id="orderForm">
      <input name="fullname" placeholder="–§–ò–û" required>
      <input name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω / Telegram" required>
      <select name="delivery" required>
        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É</option>
        <option value="–°–∞–º–æ–≤—ã–≤–æ–∑">–°–∞–º–æ–≤—ã–≤–æ–∑</option>
        <option value="–ü–æ—á—Ç–∞">–ü–æ—á—Ç–∞</option>
        <option value="–ö—É—Ä—å–µ—Ä">–ö—É—Ä—å–µ—Ä</option>
      </select>
      <input id="addressInput" placeholder="–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏" required>
      <button type="submit" style="background:#6c4cff;color:#fff;width:100%">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </form>
  </div>
</div>

<script>
// ================= –ù–ê–°–¢–†–û–ô–ö–ò =================
const BOT_TOKEN = "8146718095:AAHeQj9OdqeUuMg1zh3g1_nO9-EJskpEN74";
const CHAT_ID = "531170149";

// ================= –¢–û–í–ê–†–´ =================
const products = [
  {id:1,name:"–ë—Ä–∞—Å–ª–µ—Ç Hearts",price:4000},
  {id:2,name:"–ö–æ–ª—å–µ Gothic",price:3600},
  {id:3,name:"–°–µ—Ä—å–≥–∏ Moon",price:2000}
];

let cart = [];

const productsEl = document.getElementById("products");

function render(){
  productsEl.innerHTML="";
  products.forEach(p=>{
    const d=document.createElement("div");
    d.className="product";
    d.innerHTML=`<b>${p.name}</b><br>${p.price} ‚ÇΩ`;
    d.onclick=()=>add(p);
    productsEl.appendChild(d);
  });
}

function add(p){
  const i=cart.find(x=>x.id===p.id);
  i?i.count++:cart.push({...p,count:1});
}

render();

// ================= –ú–û–î–ê–õ–ö–ê =================
document.getElementById("openOrder").onclick=()=>{
  if(!cart.length) return alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");
  document.getElementById("orderModal").style.display="flex";
};

document.getElementById("orderModal").onclick=e=>{
  if(e.target.id==="orderModal") e.target.style.display="none";
};

// ================= –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM =================
document.getElementById("orderForm").onsubmit=e=>{
  e.preventDefault();

  const name=e.target.fullname.value.trim();
  const phone=e.target.phone.value.trim();
  const delivery=e.target.delivery.value;
  const address=document.getElementById("addressInput").value.trim();

  if(!name||!phone||!delivery||!address) return alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å—ë");

  const text =
`üõí –ù–û–í–´–ô –ó–ê–ö–ê–ó

üë§ ${name}
üìû ${phone}
üöö ${delivery}
üìç ${address}

üì¶ –¢–æ–≤–∞—Ä—ã:
${cart.map(i=>`‚Ä¢ ${i.name} x${i.count}`).join("\n")}

üí∞ ${cart.reduce((s,i)=>s+i.price*i.count,0)} ‚ÇΩ`;

  fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      chat_id:CHAT_ID,
      text
    })
  }).then(()=>{
    alert("–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
    cart=[];
    document.getElementById("orderModal").style.display="none";
  });
};

// ================= DADATA =================
$(document).ready(function(){
  $("#addressInput").suggestions({
    token:"4563b9c9765a1a2d7bf39e1c8944f7fadae05970",
    type:"ADDRESS",
    onSelect:s=>$("#addressInput").val(s.value)
  });
});
</script>

</body>
</html>
